============================= test session starts ==============================
platform darwin -- Python 3.11.13, pytest-8.4.2, pluggy-1.6.0 -- /Users/odosmatthews/.pyenv/versions/3.11.13/bin/python
cachedir: .pytest_cache
hypothesis profile 'default'
benchmark: 5.1.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /Users/odosmatthews/Documents/coding/sparkless
configfile: pyproject.toml
plugins: anyio-4.11.0, typeguard-4.4.4, green-light-0.2.0, xdist-3.8.0, timeout-2.4.0, hypothesis-6.140.3, asyncio-1.3.0, Faker-37.11.0, benchmark-5.1.0, cov-7.0.0, async-sqlalchemy-0.2.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 221 items

tests/documentation/test_examples.py::TestExampleScripts::test_basic_usage_runs PASSED [  0%]
tests/documentation/test_examples.py::TestExampleScripts::test_comprehensive_usage_runs PASSED [  0%]
tests/documentation/test_examples.py::TestExampleScripts::test_examples_show_v2_features PASSED [  1%]
tests/documentation/test_examples.py::TestExampleScripts::test_example_outputs_captured FAILED [  1%]
tests/examples/test_unified_infrastructure_example.py::TestUnifiedInfrastructure::test_basic_operation PASSED [  2%]
tests/examples/test_unified_infrastructure_example.py::TestUnifiedInfrastructure::test_mock_only PASSED [  2%]
tests/examples/test_unified_infrastructure_example.py::TestUnifiedInfrastructure::test_pyspark_only SKIPPEDcreate PySpark session: Could not
serialize object: IndexError: tuple index out of range)                  [  3%]
tests/examples/test_unified_infrastructure_example.py::TestUnifiedInfrastructure::test_comparison SKIPPEDialize object: IndexError: tuple
index out of range)                                                      [  3%]
tests/examples/test_unified_infrastructure_example.py::TestUnifiedInfrastructure::test_aggregation_comparison SKIPPEDialize object:
IndexError: tuple index out of range)                                    [  4%]
tests/examples/test_unified_infrastructure_example.py::TestUnifiedInfrastructure::test_with_backend_info PASSED [  4%]
tests/examples/test_unified_infrastructure_example.py::TestUnifiedImports::test_with_unified_imports PASSED [  4%]
tests/examples/test_unified_infrastructure_example.py::TestUnifiedImports::test_with_full_imports_object PASSED [  5%]
tests/integration/scripts/test_discover_pyspark_api.py::test_discover_pyspark_api_smoke PASSED [  5%]
tests/parity/dataframe/test_aggregations.py::TestAggregationsParity::test_sum_aggregation PASSED [  6%]
tests/parity/dataframe/test_aggregations.py::TestAggregationsParity::test_avg_aggregation PASSED [  6%]
tests/parity/dataframe/test_aggregations.py::TestAggregationsParity::test_count_aggregation PASSED [  7%]
tests/parity/dataframe/test_aggregations.py::TestAggregationsParity::test_max_aggregation PASSED [  7%]
tests/parity/dataframe/test_aggregations.py::TestAggregationsParity::test_min_aggregation PASSED [  8%]
tests/parity/dataframe/test_aggregations.py::TestAggregationsParity::test_multiple_aggregations PASSED [  8%]
tests/parity/dataframe/test_aggregations.py::TestAggregationsParity::test_groupby_multiple_columns PASSED [  9%]
tests/parity/dataframe/test_aggregations.py::TestAggregationsParity::test_global_aggregation PASSED [  9%]
tests/parity/dataframe/test_aggregations.py::TestAggregationsParity::test_aggregation_with_nulls PASSED [  9%]
tests/parity/dataframe/test_filter.py::TestFilterParity::test_filter_operations PASSED [ 10%]
tests/parity/dataframe/test_filter.py::TestFilterParity::test_filter_with_boolean PASSED [ 10%]
tests/parity/dataframe/test_groupby.py::TestGroupByParity::test_group_by FAILED [ 11%]
tests/parity/dataframe/test_groupby.py::TestGroupByParity::test_aggregation PASSED [ 11%]
tests/parity/dataframe/test_join.py::TestJoinParity::test_inner_join PASSED [ 12%]
tests/parity/dataframe/test_join.py::TestJoinParity::test_left_join PASSED [ 12%]
tests/parity/dataframe/test_join.py::TestJoinParity::test_right_join PASSED [ 13%]
tests/parity/dataframe/test_join.py::TestJoinParity::test_outer_join PASSED [ 13%]
tests/parity/dataframe/test_join.py::TestJoinParity::test_cross_join PASSED [ 14%]
tests/parity/dataframe/test_join.py::TestJoinParity::test_semi_join PASSED [ 14%]
tests/parity/dataframe/test_join.py::TestJoinParity::test_anti_join PASSED [ 14%]
tests/parity/dataframe/test_select.py::TestSelectParity::test_basic_select PASSED [ 15%]
tests/parity/dataframe/test_select.py::TestSelectParity::test_select_with_alias PASSED [ 15%]
tests/parity/dataframe/test_select.py::TestSelectParity::test_column_access PASSED [ 16%]
tests/parity/dataframe/test_set_operations.py::TestSetOperationsParity::test_union PASSED [ 16%]
tests/parity/dataframe/test_set_operations.py::TestSetOperationsParity::test_union_all PASSED [ 17%]
tests/parity/dataframe/test_set_operations.py::TestSetOperationsParity::test_intersect PASSED [ 17%]
tests/parity/dataframe/test_set_operations.py::TestSetOperationsParity::test_except PASSED [ 18%]
tests/parity/dataframe/test_transformations.py::TestTransformationsParity::test_with_column PASSED [ 18%]
tests/parity/dataframe/test_transformations.py::TestTransformationsParity::test_drop_column PASSED [ 19%]
tests/parity/dataframe/test_transformations.py::TestTransformationsParity::test_distinct PASSED [ 19%]
tests/parity/dataframe/test_transformations.py::TestTransformationsParity::test_order_by PASSED [ 19%]
tests/parity/dataframe/test_transformations.py::TestTransformationsParity::test_order_by_desc PASSED [ 20%]
tests/parity/dataframe/test_transformations.py::TestTransformationsParity::test_limit PASSED [ 20%]
tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_row_number PASSED [ 21%]
tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_rank PASSED [ 21%]
tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_dense_rank PASSED [ 22%]
tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_sum_over_window FAILED [ 22%]
tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_lag FAILED [ 23%]
tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_lead FAILED [ 23%]
tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_cume_dist PASSED [ 23%]
tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_first_value PASSED [ 24%]
tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_last_value PASSED [ 24%]
tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_percent_rank PASSED [ 25%]
tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_ntile PASSED [ 25%]
tests/parity/functions/test_aggregate.py::TestAggregateFunctionsParity::test_agg_sum PASSED [ 26%]
tests/parity/functions/test_aggregate.py::TestAggregateFunctionsParity::test_agg_avg PASSED [ 26%]
tests/parity/functions/test_aggregate.py::TestAggregateFunctionsParity::test_agg_count PASSED [ 27%]
tests/parity/functions/test_aggregate.py::TestAggregateFunctionsParity::test_agg_max PASSED [ 27%]
tests/parity/functions/test_aggregate.py::TestAggregateFunctionsParity::test_agg_min PASSED [ 28%]
tests/parity/functions/test_array.py::TestArrayFunctionsParity::test_array_contains PASSED [ 28%]
tests/parity/functions/test_array.py::TestArrayFunctionsParity::test_array_position PASSED [ 28%]
tests/parity/functions/test_array.py::TestArrayFunctionsParity::test_size PASSED [ 29%]
tests/parity/functions/test_array.py::TestArrayFunctionsParity::test_element_at PASSED [ 29%]
tests/parity/functions/test_array.py::TestArrayFunctionsParity::test_explode PASSED [ 30%]
tests/parity/functions/test_array.py::TestArrayFunctionsParity::test_array_distinct PASSED [ 30%]
tests/parity/functions/test_array.py::TestArrayFunctionsParity::test_array_join FAILED [ 31%]
tests/parity/functions/test_array.py::TestArrayFunctionsParity::test_array_union FAILED [ 31%]
tests/parity/functions/test_array.py::TestArrayFunctionsParity::test_array_sort FAILED [ 32%]
tests/parity/functions/test_array.py::TestArrayFunctionsParity::test_array_remove PASSED [ 32%]
tests/parity/functions/test_datetime.py::TestDatetimeFunctionsParity::test_year PASSED [ 33%]
tests/parity/functions/test_datetime.py::TestDatetimeFunctionsParity::test_month PASSED [ 33%]
tests/parity/functions/test_datetime.py::TestDatetimeFunctionsParity::test_dayofmonth FAILED [ 33%]
tests/parity/functions/test_datetime.py::TestDatetimeFunctionsParity::test_dayofweek PASSED [ 34%]
tests/parity/functions/test_datetime.py::TestDatetimeFunctionsParity::test_date_add PASSED [ 34%]
tests/parity/functions/test_datetime.py::TestDatetimeFunctionsParity::test_date_sub PASSED [ 35%]
tests/parity/functions/test_datetime.py::TestDatetimeFunctionsParity::test_date_format PASSED [ 35%]
tests/parity/functions/test_datetime.py::TestDatetimeFunctionsParity::test_to_date PASSED [ 36%]
tests/parity/functions/test_math.py::TestMathFunctionsParity::test_math_abs PASSED [ 36%]
tests/parity/functions/test_math.py::TestMathFunctionsParity::test_math_round PASSED [ 37%]
tests/parity/functions/test_math.py::TestMathFunctionsParity::test_math_sqrt PASSED [ 37%]
tests/parity/functions/test_math.py::TestMathFunctionsParity::test_math_pow PASSED [ 38%]
tests/parity/functions/test_math.py::TestMathFunctionsParity::test_math_log PASSED [ 38%]
tests/parity/functions/test_math.py::TestMathFunctionsParity::test_math_exp PASSED [ 38%]
tests/parity/functions/test_math.py::TestMathFunctionsParity::test_math_sin PASSED [ 39%]
tests/parity/functions/test_math.py::TestMathFunctionsParity::test_math_cos PASSED [ 39%]
tests/parity/functions/test_math.py::TestMathFunctionsParity::test_math_tan PASSED [ 40%]
tests/parity/functions/test_math.py::TestMathFunctionsParity::test_math_ceil PASSED [ 40%]
tests/parity/functions/test_math.py::TestMathFunctionsParity::test_math_floor PASSED [ 41%]
tests/parity/functions/test_math.py::TestMathFunctionsParity::test_math_greatest PASSED [ 41%]
tests/parity/functions/test_math.py::TestMathFunctionsParity::test_math_least PASSED [ 42%]
tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_coalesce FAILED [ 42%]
tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_isnull FAILED [ 42%]
tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_isnotnull FAILED [ 43%]
tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_when_otherwise FAILED [ 43%]
tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_nvl FAILED [ 44%]
tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_nullif FAILED [ 44%]
tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_ifnull PASSED [ 45%]
tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_nanvl PASSED [ 45%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_upper PASSED [ 46%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_lower PASSED [ 46%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_length PASSED [ 47%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_substring PASSED [ 47%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_concat PASSED [ 47%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_split PASSED [ 48%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_regexp_extract PASSED [ 48%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_trim PASSED [ 49%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_ltrim PASSED [ 49%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_rtrim PASSED [ 50%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_lpad PASSED [ 50%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_rpad PASSED [ 51%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_like PASSED [ 51%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_string_rlike PASSED [ 52%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_concat_ws PASSED [ 52%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_ascii PASSED [ 52%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_hex PASSED [ 53%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_base64 PASSED [ 53%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_initcap PASSED [ 54%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_repeat PASSED [ 54%]
tests/parity/functions/test_string.py::TestStringFunctionsParity::test_reverse PASSED [ 55%]
tests/parity/internal/test_catalog.py::TestCatalogParity::test_list_databases PASSED [ 55%]
tests/parity/internal/test_catalog.py::TestCatalogParity::test_create_database_catalog PASSED [ 56%]
tests/parity/internal/test_catalog.py::TestCatalogParity::test_drop_database_catalog PASSED [ 56%]
tests/parity/internal/test_catalog.py::TestCatalogParity::test_set_current_database PASSED [ 57%]
tests/parity/internal/test_catalog.py::TestCatalogParity::test_list_tables PASSED [ 57%]
tests/parity/internal/test_catalog.py::TestCatalogParity::test_list_tables_in_database PASSED [ 57%]
tests/parity/internal/test_catalog.py::TestCatalogParity::test_table_exists PASSED [ 58%]
tests/parity/internal/test_catalog.py::TestCatalogParity::test_table_exists_in_database PASSED [ 58%]
tests/parity/internal/test_catalog.py::TestCatalogParity::test_get_table PASSED [ 59%]
tests/parity/internal/test_catalog.py::TestCatalogParity::test_get_table_in_database FAILED [ 59%]
tests/parity/internal/test_catalog.py::TestCatalogParity::test_cache_table PASSED [ 60%]
tests/parity/internal/test_catalog.py::TestCatalogParity::test_uncache_table PASSED [ 60%]
tests/parity/internal/test_catalog.py::TestCatalogParity::test_is_cached PASSED [ 61%]
tests/parity/internal/test_session.py::TestSessionParity::test_createDataFrame_from_list_of_dicts PASSED [ 61%]
tests/parity/internal/test_session.py::TestSessionParity::test_createDataFrame_with_explicit_schema PASSED [ 61%]
tests/parity/internal/test_session.py::TestSessionParity::test_createDataFrame_empty PASSED [ 62%]
tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_inner_join FAILED [ 62%]
tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_left_join PASSED [ 63%]
tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_order_by PASSED [ 63%]
tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_limit PASSED [ 64%]
tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_having FAILED [ 64%]
tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_union PASSED [ 65%]
tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_subquery FAILED [ 65%]
tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_case_when PASSED [ 66%]
tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_like FAILED [ 66%]
tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_in_clause FAILED [ 66%]
tests/parity/sql/test_ddl.py::TestSQLDDLParity::test_create_database PASSED [ 67%]
tests/parity/sql/test_ddl.py::TestSQLDDLParity::test_create_database_if_not_exists PASSED [ 67%]
tests/parity/sql/test_ddl.py::TestSQLDDLParity::test_drop_database PASSED [ 68%]
tests/parity/sql/test_ddl.py::TestSQLDDLParity::test_create_table_from_dataframe PASSED [ 68%]
tests/parity/sql/test_ddl.py::TestSQLDDLParity::test_create_table_with_select FAILED [ 69%]
tests/parity/sql/test_ddl.py::TestSQLDDLParity::test_drop_table PASSED   [ 69%]
tests/parity/sql/test_ddl.py::TestSQLDDLParity::test_drop_table_if_exists PASSED [ 70%]
tests/parity/sql/test_ddl.py::TestSQLDDLParity::test_create_schema PASSED [ 70%]
tests/parity/sql/test_ddl.py::TestSQLDDLParity::test_set_current_database PASSED [ 71%]
tests/parity/sql/test_ddl.py::TestSQLDDLParity::test_table_in_specific_database PASSED [ 71%]
tests/parity/sql/test_dml.py::TestSQLDMLParity::test_insert_into_table FAILED [ 71%]
tests/parity/sql/test_dml.py::TestSQLDMLParity::test_insert_into_specific_columns PASSED [ 72%]
tests/parity/sql/test_dml.py::TestSQLDMLParity::test_insert_multiple_values PASSED [ 72%]
tests/parity/sql/test_dml.py::TestSQLDMLParity::test_update_table FAILED [ 73%]
tests/parity/sql/test_dml.py::TestSQLDMLParity::test_update_multiple_columns PASSED [ 73%]
tests/parity/sql/test_dml.py::TestSQLDMLParity::test_delete_from_table PASSED [ 74%]
tests/parity/sql/test_dml.py::TestSQLDMLParity::test_delete_all_rows PASSED [ 74%]
tests/parity/sql/test_dml.py::TestSQLDMLParity::test_insert_from_select FAILED [ 75%]
tests/parity/sql/test_queries.py::TestSQLQueriesParity::test_basic_select FAILED [ 75%]
tests/parity/sql/test_queries.py::TestSQLQueriesParity::test_filtered_select FAILED [ 76%]
tests/parity/sql/test_queries.py::TestSQLQueriesParity::test_group_by FAILED [ 76%]
tests/parity/sql/test_queries.py::TestSQLQueriesParity::test_aggregation FAILED [ 76%]
tests/parity/sql/test_show_describe.py::TestSQLShowDescribeParity::test_show_databases FAILED [ 77%]
tests/parity/sql/test_show_describe.py::TestSQLShowDescribeParity::test_show_tables FAILED [ 77%]
tests/parity/sql/test_show_describe.py::TestSQLShowDescribeParity::test_show_tables_in_database FAILED [ 78%]
tests/parity/sql/test_show_describe.py::TestSQLShowDescribeParity::test_describe_table FAILED [ 78%]
tests/parity/sql/test_show_describe.py::TestSQLShowDescribeParity::test_describe_extended FAILED [ 79%]
tests/parity/sql/test_show_describe.py::TestSQLShowDescribeParity::test_describe_column FAILED [ 79%]
tests/parity/sql/test_show_describe.py::TestSQLShowDescribeParity::test_show_columns PASSED [ 80%]
tests/test_column_availability.py::TestColumnAvailability::test_materialized_columns_are_available PASSED [ 80%]
tests/test_column_availability.py::TestColumnAvailability::test_columns_available_after_collect PASSED [ 80%]
tests/test_column_availability.py::TestColumnAvailability::test_columns_available_after_show PASSED [ 81%]
tests/test_column_availability.py::TestColumnAvailability::test_dataframe_is_marked_materialized PASSED [ 81%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_lit_none_works PASSED [ 82%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_type_casting_works PASSED [ 82%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_null_literal_casting_to_various_types PASSED [ 83%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_null_cast_preserves_schema_type PASSED [ 83%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_add_column_with_null_and_type PASSED [ 84%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_add_column_from_struct_field PASSED [ 84%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_schema_merge_with_type_preservation PASSED [ 85%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_immediate_table_access PASSED [ 85%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_basic_schema_evolution PASSED [ 85%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_overwrite_schema_option PASSED [ 86%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_preserve_existing_columns PASSED [ 86%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_schema_merge_on_overwrite PASSED [ 87%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_merge_schema_append PASSED [ 87%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_merge_schema_bidirectional PASSED [ 88%]
tests/test_delta_lake_schema_evolution.py::TestDeltaLakeSchemaEvolution::test_complete_schema_evolution_scenario PASSED [ 88%]
tests/test_fixture_compatibility.py::TestFixtureCompatibility::test_session_creation_in_fixture PASSED [ 89%]
tests/test_fixture_compatibility.py::TestFixtureCompatibility::test_multiple_sessions_in_fixture PASSED [ 89%]
tests/test_fixture_compatibility.py::TestFixtureCompatibility::test_session_context_manager PASSED [ 90%]
tests/test_fixture_compatibility.py::TestFixtureCompatibility::test_session_cleanup_after_test PASSED [ 90%]
tests/test_fixture_compatibility.py::TestFixtureCompatibility::test_sparkcontext_available_in_session PASSED [ 90%]
tests/test_function_api_compatibility.py::TestFunctionAPIs::test_current_date_is_function_not_method PASSED [ 91%]
tests/test_function_api_compatibility.py::TestFunctionAPIs::test_current_timestamp_is_function_not_method PASSED [ 91%]
tests/test_function_api_compatibility.py::TestFunctionAPIs::test_functions_are_static_methods PASSED [ 92%]
tests/test_function_api_compatibility.py::TestFunctionAPIs::test_function_signatures_match_pyspark PASSED [ 92%]
tests/test_notebooks.py::test_quickstart PASSED                          [ 93%]
tests/test_notebooks.py::test_dataframe_operations PASSED                [ 93%]
tests/test_sparkcontext_validation.py::TestSessionValidation::test_col_does_not_require_active_session PASSED [ 94%]
tests/test_sparkcontext_validation.py::TestSessionValidation::test_col_works_with_active_session PASSED [ 94%]
tests/test_sparkcontext_validation.py::TestSessionValidation::test_col_works_after_session_stopped PASSED [ 95%]
tests/test_sparkcontext_validation.py::TestSessionValidation::test_lit_does_not_require_active_session PASSED [ 95%]
tests/test_sparkcontext_validation.py::TestSessionValidation::test_expr_requires_active_session PASSED [ 95%]
tests/test_sparkcontext_validation.py::TestSessionValidation::test_when_requires_active_session PASSED [ 96%]
tests/test_sparkcontext_validation.py::TestSessionValidation::test_aggregate_functions_require_session FAILED [ 96%]
tests/test_sparkcontext_validation.py::TestSessionValidation::test_window_functions_require_session PASSED [ 97%]
tests/test_sparkcontext_validation.py::TestSessionValidation::test_datetime_functions_require_session PASSED [ 97%]
tests/test_sparkcontext_validation.py::TestSessionValidation::test_multiple_sessions PASSED [ 98%]
tests/test_type_strictness.py::TestTypeStrictness::test_to_timestamp_requires_string PASSED [ 98%]
tests/test_type_strictness.py::TestTypeStrictness::test_to_timestamp_works_with_string PASSED [ 99%]
tests/test_type_strictness.py::TestTypeStrictness::test_to_date_requires_string PASSED [ 99%]
tests/test_type_strictness.py::TestTypeStrictness::test_to_date_works_with_string PASSED [100%]

=================================== FAILURES ===================================
_______________ TestExampleScripts.test_example_outputs_captured _______________
tests/documentation/test_examples.py:165: in test_example_outputs_captured
    assert "Mock Spark" in basic_output
E   AssertionError: assert 'Mock Spark' in '\U0001f680 Sparkless - Basic Usage Example\n============================================================\n\n1\ufe0f\u20e3  Creating Sparkless Session...\n   \u2713 Session created: BasicExample\n\n2\ufe0f\u20e3  Creating DataFrame...\n   \u2713 Created DataFrame: 5 rows, 4 columns\n\n   Schema:\nMockDataFrame Schema:\n |-- dept: StringType (nullable)\n |-- id: LongType (nullable)\n |-- name: StringType (nullable)\n |-- salary: LongType (nullable)\n\n   Data:\nMockDataFrame[5 rows, 4 columns]\n\ndept        id name    salary\nEngineering   1    Alice     80000   \nSales         2    Bob       75000   \nEngineering   3    Charlie   90000   \nMarketing     4    Diana     70000   \nSales         5    Eve       85000   \n\n3\ufe0f\u20e3  Filtering...\n   \u2713 Employees earning > $75k: 3\nMockDataFrame[5 rows, 4 columns]\n\ndept        id name    salary\nEngineering   1    Alice     80000   \nSales         2    Bob       75000   \nEngineering   3    Charlie   90000   \nMarketing     4    Diana     70000   \nSales         5    Eve       85000   \n\n4\ufe0f\u20e3  Column Operations...\n   \u2713 Applied transformations:\nMockDataFrame[5 rows, 4 columns]\n\ndept        id name    salary\nEngineering   1    Alice     80000   \nSales         2    Bob       75000   \nEngineering   3    Charlie   90000   \nMarketing     4    Diana     70000   \nSales         5    Eve       85000   \n\n5\ufe0f\u20e3  Aggregations...\n   \u2713 Department statistics:\nMockDataFrame[3 rows, 4 columns]\n\ndept        count avg_salary max_salary\nEngineering   2       85000.0      90000       \nSales         2       80000.0      85000       \nMarketing     1       70000.0      70000       \n\n6\ufe0f\u20e3  Window Functions...\n   \u2713 Salary rankings by department:\nMockDataFrame[5 rows, 4 columns]\n\ndept        id name    salary\nEngineering   1    Alice     80000   \nSales         2    Bob       75000   \nEngineering   3    Charlie   90000   \nMarketing     4    Diana     70000   \nSales         5    Eve       85000   \n\n7\ufe0f\u20e3  Joins...\n   \u2713 Joined with department locations:\nMockDataFrame[5 rows, 4 columns]\n\ndept        id name    salary\nEngineering   1    Alice     80000   \nSales         2    Bob       75000   \nEngineering   3    Charlie   90000   \nMarketing     4    Diana     70000   \nSales         5    Eve       85000   \n\n8\ufe0f\u20e3  SQL Queries...\n   \u2713 SQL query result (salary > 80k):\nMockDataFrame[5 rows, 3 columns]\n\ndept        id name    salary\nEngineering   1    Alice     80000   \nSales         2    Bob       75000   \nEngineering   3    Charlie   90000   \nMarketing     4    Diana     70000   \nSales         5    Eve       85000   \n\n9\ufe0f\u20e3  Lazy Evaluation...\n   \u2713 Transformations queued (not executed yet)\n   \u2713 Action executed: 4 results\n     - Charlie: $90,000\n     - Eve: $85,000\n     - Alice: $80,000\n     - Bob: $75,000\n\n\U0001f51f Cleanup...\n   \u2713 Session stopped\n\n\u2728 Example completed successfully!\n\n\U0001f4a1 Key Takeaways:\n   \u2022 Sparkless provides drop-in PySpark replacement\n   \u2022 No JVM required - 10x faster tests\n   \u2022 Full API compatibility with lazy evaluation\n   \u2022 Perfect for unit testing and CI/CD\n'
_______________________ TestGroupByParity.test_group_by ________________________
tests/parity/dataframe/test_groupby.py:22: in test_group_by
    self.assert_parity(result, expected)
tests/fixtures/parity_base.py:64: in assert_parity
    assert_dataframes_equal(
tests/tools/comparison_utils.py:797: in assert_dataframes_equal
    raise AssertionError(f"{error_msg}:\n{error_details}")
E   AssertionError: DataFrames are not equivalent:
E   Schema field names mismatch: mock=['department', 'count(1)'], expected=['department', 'count']
_______________ TestWindowOperationsParity.test_sum_over_window ________________
tests/parity/dataframe/test_window.py:54: in test_sum_over_window
    self.assert_parity(result, expected)
tests/fixtures/parity_base.py:64: in assert_parity
    assert_dataframes_equal(
tests/tools/comparison_utils.py:797: in assert_dataframes_equal
    raise AssertionError(f"{error_msg}:\n{error_details}")
E   AssertionError: DataFrames are not equivalent:
E   Row count mismatch: mock=0, expected=4
_____________________ TestWindowOperationsParity.test_lag ______________________
tests/parity/dataframe/test_window.py:64: in test_lag
    self.assert_parity(result, expected)
tests/fixtures/parity_base.py:64: in assert_parity
    assert_dataframes_equal(
tests/tools/comparison_utils.py:797: in assert_dataframes_equal
    raise AssertionError(f"{error_msg}:\n{error_details}")
E   AssertionError: DataFrames are not equivalent:
E   Schema field names mismatch: mock=['dept', 'hire_date', 'id', 'name', 'salary', 'prev_salary'], expected=['dept', 'hire_date', 'id', 'name', 'salary', 'lag_salary']
_____________________ TestWindowOperationsParity.test_lead _____________________
tests/parity/dataframe/test_window.py:74: in test_lead
    self.assert_parity(result, expected)
tests/fixtures/parity_base.py:64: in assert_parity
    assert_dataframes_equal(
tests/tools/comparison_utils.py:797: in assert_dataframes_equal
    raise AssertionError(f"{error_msg}:\n{error_details}")
E   AssertionError: DataFrames are not equivalent:
E   Schema field names mismatch: mock=['dept', 'hire_date', 'id', 'name', 'salary', 'next_salary'], expected=['dept', 'hire_date', 'id', 'name', 'salary', 'lead_salary']
___________________ TestArrayFunctionsParity.test_array_join ___________________
tests/parity/functions/test_array.py:61: in test_array_join
    result = df.select(F.array_join(df.tags, ","))
                                    ^^^^^^^
sparkless/dataframe/dataframe.py:879: in __getattr__
    return DataFrameAttributeHandler.handle_getattr(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/dataframe/attribute_handler.py:76: in handle_getattr
    raise SparkColumnNotFoundError(name, available_cols)
E   sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'tags'. Available columns: arr1, arr2, arr3, id, value
__________________ TestArrayFunctionsParity.test_array_union ___________________
tests/parity/functions/test_array.py:68: in test_array_union
    result = df.select(F.array_union(df.scores, F.array(F.lit(100))))
                                     ^^^^^^^^^
sparkless/dataframe/dataframe.py:879: in __getattr__
    return DataFrameAttributeHandler.handle_getattr(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/dataframe/attribute_handler.py:76: in handle_getattr
    raise SparkColumnNotFoundError(name, available_cols)
E   sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'scores'. Available columns: arr1, arr2, arr3, id, value
___________________ TestArrayFunctionsParity.test_array_sort ___________________
tests/parity/functions/test_array.py:75: in test_array_sort
    result = df.select(F.array_sort(df.scores))
                                    ^^^^^^^^^
sparkless/dataframe/dataframe.py:879: in __getattr__
    return DataFrameAttributeHandler.handle_getattr(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/dataframe/attribute_handler.py:76: in handle_getattr
    raise SparkColumnNotFoundError(name, available_cols)
E   sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'scores'. Available columns: arr1, arr2, arr3, id, value
_________________ TestDatetimeFunctionsParity.test_dayofmonth __________________
tests/parity/functions/test_datetime.py:33: in test_dayofmonth
    result = df.select(F.dayofmonth(df.hire_date))
                                    ^^^^^^^^^^^^
sparkless/dataframe/dataframe.py:879: in __getattr__
    return DataFrameAttributeHandler.handle_getattr(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/dataframe/attribute_handler.py:76: in handle_getattr
    raise SparkColumnNotFoundError(name, available_cols)
E   sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'hire_date'. Available columns: date, id, timestamp
________________ TestNullHandlingFunctionsParity.test_coalesce _________________
tests/parity/functions/test_null_handling.py:19: in test_coalesce
    result = df.select(F.coalesce(df.col1, df.col2, df.col3).alias("first_non_null"))
                                  ^^^^^^^
sparkless/dataframe/dataframe.py:879: in __getattr__
    return DataFrameAttributeHandler.handle_getattr(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/dataframe/attribute_handler.py:76: in handle_getattr
    raise SparkColumnNotFoundError(name, available_cols)
E   sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'col1'. Available columns: age, department, id, name, salary
_________________ TestNullHandlingFunctionsParity.test_isnull __________________
tests/parity/functions/test_null_handling.py:26: in test_isnull
    result = df.select(F.isnull(df.value))
                                ^^^^^^^^
sparkless/dataframe/dataframe.py:879: in __getattr__
    return DataFrameAttributeHandler.handle_getattr(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/dataframe/attribute_handler.py:76: in handle_getattr
    raise SparkColumnNotFoundError(name, available_cols)
E   sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'value'. Available columns: age, department, id, name, salary
________________ TestNullHandlingFunctionsParity.test_isnotnull ________________
tests/parity/functions/test_null_handling.py:33: in test_isnotnull
    result = df.select(F.isnotnull(df.value))
                                   ^^^^^^^^
sparkless/dataframe/dataframe.py:879: in __getattr__
    return DataFrameAttributeHandler.handle_getattr(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/dataframe/attribute_handler.py:76: in handle_getattr
    raise SparkColumnNotFoundError(name, available_cols)
E   sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'value'. Available columns: age, department, id, name, salary
_____________ TestNullHandlingFunctionsParity.test_when_otherwise ______________
tests/parity/functions/test_null_handling.py:41: in test_when_otherwise
    self.assert_parity(result, expected)
tests/fixtures/parity_base.py:64: in assert_parity
    assert_dataframes_equal(
tests/tools/comparison_utils.py:797: in assert_dataframes_equal
    raise AssertionError(f"{error_msg}:\n{error_details}")
E   AssertionError: DataFrames are not equivalent:
E   Schema field names mismatch: mock=['level'], expected=['CASE WHEN (salary IS NULL) THEN 0 ELSE salary END']
E   Null mismatch in column 'level' row 0: mock=Junior, expected=0.0
E   Null mismatch in column 'level' row 1: mock=Junior, expected=50000.0
E   Null mismatch in column 'level' row 2: mock=Junior, expected=70000.0
E   Null mismatch in column 'level' row 3: mock=Senior, expected=80000.0
___________________ TestNullHandlingFunctionsParity.test_nvl ___________________
tests/parity/functions/test_null_handling.py:47: in test_nvl
    result = df.select(F.nvl(df.value, 0))
                             ^^^^^^^^
sparkless/dataframe/dataframe.py:879: in __getattr__
    return DataFrameAttributeHandler.handle_getattr(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/dataframe/attribute_handler.py:76: in handle_getattr
    raise SparkColumnNotFoundError(name, available_cols)
E   sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'value'. Available columns: age, department, id, name, salary
_________________ TestNullHandlingFunctionsParity.test_nullif __________________
tests/parity/functions/test_null_handling.py:54: in test_nullif
    result = df.select(F.nullif(df.col1, df.col2))
                                ^^^^^^^
sparkless/dataframe/dataframe.py:879: in __getattr__
    return DataFrameAttributeHandler.handle_getattr(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/dataframe/attribute_handler.py:76: in handle_getattr
    raise SparkColumnNotFoundError(name, available_cols)
E   sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'col1'. Available columns: age, department, id, name, salary
_________________ TestCatalogParity.test_get_table_in_database _________________
tests/parity/internal/test_catalog.py:166: in test_get_table_in_database
    table = spark.catalog.getTable("get_db", "get_table")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/session/catalog.py:625: in getTable
    raise AnalysisException(f"Table '{qualified_name}' does not exist")
E   sparkless.core.exceptions.analysis.AnalysisException: Table 'get_table.get_db' does not exist
________________ TestSQLAdvancedParity.test_sql_with_inner_join ________________
tests/parity/sql/test_advanced.py:34: in test_sql_with_inner_join
    assert len(rows) == 2  # Only Alice and Bob have matching dept
    ^^^^^^^^^^^^^^^^^^^^^
E   assert 3 == 2
E    +  where 3 = len([Row(name=Alice, dept_name=Alice), Row(name=Bob, dept_name=Bob), Row(name=Charlie, dept_name=Charlie)])
__________________ TestSQLAdvancedParity.test_sql_with_having __________________
tests/parity/sql/test_advanced.py:119: in test_sql_with_having
    assert len(rows) == 1  # Only IT has avg > 55000
    ^^^^^^^^^^^^^^^^^^^^^
E   assert 0 == 1
E    +  where 0 = len([])
_________________ TestSQLAdvancedParity.test_sql_with_subquery _________________
tests/parity/sql/test_advanced.py:165: in test_sql_with_subquery
    assert len(rows) == 1
E   assert 3 == 1
E    +  where 3 = len([Row(name=Alice, salary=50000), Row(name=Bob, salary=60000), Row(name=Charlie, salary=70000)])
___________________ TestSQLAdvancedParity.test_sql_with_like ___________________
tests/parity/sql/test_advanced.py:206: in test_sql_with_like
    assert len(rows) == 1
E   assert 4 == 1
E    +  where 4 = len([Row(name=Alice), Row(name=Bob), Row(name=Charlie), Row(name=David)])
________________ TestSQLAdvancedParity.test_sql_with_in_clause _________________
tests/parity/sql/test_advanced.py:222: in test_sql_with_in_clause
    assert len(rows) == 2
E   assert 3 == 2
E    +  where 3 = len([Row(age=25, name=Alice), Row(age=30, name=Bob), Row(age=35, name=Charlie)])
________________ TestSQLDDLParity.test_create_table_with_select ________________
tests/parity/sql/test_ddl.py:81: in test_create_table_with_select
    spark.sql("CREATE TABLE IF NOT EXISTS it_employees AS SELECT name, age FROM employees WHERE dept = 'IT'")
sparkless/session/core/session.py:321: in sql
    return self._sql_impl(query, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/session/core/session.py:342: in _real_sql
    return self._sql_executor.execute(query)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/session/sql/executor.py:86: in execute
    return self._execute_create(ast)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/session/sql/executor.py:711: in _execute_create
    raise QueryExecutionException(
E   sparkless.core.exceptions.execution.QueryExecutionException: CREATE TABLE requires column definitions
___________________ TestSQLDMLParity.test_insert_into_table ____________________
tests/parity/sql/test_dml.py:28: in test_insert_into_table
    assert rows[0]["name"] == "Alice"
E   AssertionError: assert '30' == 'Alice'
E     
E     - Alice
E     + 30
______________________ TestSQLDMLParity.test_update_table ______________________
tests/parity/sql/test_dml.py:86: in test_update_table
    assert len(rows) == 1
E   assert 3 == 1
E    +  where 3 = len([Row(age=26, name=Alice), Row(age=30, name=Bob), Row(age=35, name=Charlie)])
___________________ TestSQLDMLParity.test_insert_from_select ___________________
tests/parity/sql/test_dml.py:166: in test_insert_from_select
    assert len(rows) == 2
E   assert 3 == 2
E    +  where 3 = len([Row(name=Alice, age=25), Row(name=Bob, age=30), Row(name=Charlie, age=35)])
____________________ TestSQLQueriesParity.test_basic_select ____________________
tests/parity/sql/test_queries.py:25: in test_basic_select
    self.assert_parity(result, expected)
tests/fixtures/parity_base.py:64: in assert_parity
    assert_dataframes_equal(
tests/tools/comparison_utils.py:797: in assert_dataframes_equal
    raise AssertionError(f"{error_msg}:\n{error_details}")
E   AssertionError: DataFrames are not equivalent:
E   Schema field count mismatch: mock=4, expected=3
__________________ TestSQLQueriesParity.test_filtered_select ___________________
tests/parity/sql/test_queries.py:36: in test_filtered_select
    self.assert_parity(result, expected)
tests/fixtures/parity_base.py:64: in assert_parity
    assert_dataframes_equal(
tests/tools/comparison_utils.py:797: in assert_dataframes_equal
    raise AssertionError(f"{error_msg}:\n{error_details}")
E   AssertionError: DataFrames are not equivalent:
E   Row count mismatch: mock=2, expected=1
______________________ TestSQLQueriesParity.test_group_by ______________________
sparkless/session/sql/executor.py:82: in execute
    return self._execute_select(ast)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/session/sql/executor.py:398: in _execute_select
    grouped = df_ops.groupBy(*group_by_columns)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/dataframe/dataframe.py:400: in groupBy
    return self._aggregations.groupBy(*columns)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/dataframe/services/aggregation_service.py:49: in groupBy
    raise SparkColumnNotFoundError(col_name, available_columns)
E   sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'department'. Available columns: age, id, name, salary

During handling of the above exception, another exception occurred:
tests/parity/sql/test_queries.py:45: in test_group_by
    result = spark.sql("SELECT department, COUNT(*) as count FROM test_table GROUP BY department")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/session/core/session.py:321: in sql
    return self._sql_impl(query, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/session/core/session.py:342: in _real_sql
    return self._sql_executor.execute(query)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/session/sql/executor.py:111: in execute
    raise QueryExecutionException(f"Failed to execute query: {str(e)}")
E   sparkless.core.exceptions.execution.QueryExecutionException: Failed to execute query: 'DataFrame' object has no attribute 'department'. Available columns: age, id, name, salary
____________________ TestSQLQueriesParity.test_aggregation _____________________
sparkless/session/sql/executor.py:82: in execute
    return self._execute_select(ast)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/session/sql/executor.py:398: in _execute_select
    grouped = df_ops.groupBy(*group_by_columns)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/dataframe/dataframe.py:400: in groupBy
    return self._aggregations.groupBy(*columns)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/dataframe/services/aggregation_service.py:49: in groupBy
    raise SparkColumnNotFoundError(col_name, available_columns)
E   sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'department'. Available columns: age, id, name, salary

During handling of the above exception, another exception occurred:
tests/parity/sql/test_queries.py:56: in test_aggregation
    result = spark.sql("SELECT department, AVG(salary) as avg_salary, COUNT(*) as count FROM test_table GROUP BY department")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/session/core/session.py:321: in sql
    return self._sql_impl(query, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/session/core/session.py:342: in _real_sql
    return self._sql_executor.execute(query)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sparkless/session/sql/executor.py:111: in execute
    raise QueryExecutionException(f"Failed to execute query: {str(e)}")
E   sparkless.core.exceptions.execution.QueryExecutionException: Failed to execute query: 'DataFrame' object has no attribute 'department'. Available columns: age, id, name, salary
________________ TestSQLShowDescribeParity.test_show_databases _________________
tests/parity/sql/test_show_describe.py:25: in test_show_databases
    assert "show_test_db" in db_names
E   AssertionError: assert 'show_test_db' in ['default', 'test']
__________________ TestSQLShowDescribeParity.test_show_tables __________________
tests/parity/sql/test_show_describe.py:42: in test_show_tables
    assert "show_test_table" in table_names
E   AssertionError: assert 'show_test_table' in ['users', 'orders']
____________ TestSQLShowDescribeParity.test_show_tables_in_database ____________
tests/parity/sql/test_show_describe.py:61: in test_show_tables_in_database
    assert "show_table" in table_names
E   AssertionError: assert 'show_table' in ['users', 'orders']
________________ TestSQLShowDescribeParity.test_describe_table _________________
tests/parity/sql/test_show_describe.py:79: in test_describe_table
    assert len(columns) == 3
E   assert 0 == 3
E    +  where 0 = len([])
_______________ TestSQLShowDescribeParity.test_describe_extended _______________
tests/parity/sql/test_show_describe.py:100: in test_describe_extended
    assert len(rows) > 2
E   assert 0 > 2
E    +  where 0 = len([])
________________ TestSQLShowDescribeParity.test_describe_column ________________
tests/parity/sql/test_show_describe.py:121: in test_describe_column
    assert len(rows) >= 1
E   assert 0 >= 1
E    +  where 0 = len([])
________ TestSessionValidation.test_aggregate_functions_require_session ________
tests/test_sparkcontext_validation.py:78: in test_aggregate_functions_require_session
    with pytest.raises(RuntimeError, match="No active SparkSession found"):
E   Failed: DID NOT RAISE <class 'RuntimeError'>
================================ tests coverage ================================
______________ coverage: platform darwin, python 3.11.13-final-0 _______________

Name                                                       Stmts   Miss  Cover   Missing
----------------------------------------------------------------------------------------
sparkless/__init__.py                                         24      0   100%
sparkless/_version.py                                          8      2    75%   10-12
sparkless/backend/__init__.py                                  3      0   100%
sparkless/backend/factory.py                                  95     55    42%   53-80, 107-128, 143-168, 188-202, 213, 228, 245
sparkless/backend/polars/__init__.py                           4      0   100%
sparkless/backend/polars/export.py                            36     28    22%   27-53, 67-76, 88-89, 102-103, 113-114
sparkless/backend/polars/expression_translator.py           1075    674    37%   33-35, 64-66, 75, 78, 81, 84, 90, 94, 98, 101, 133, 155, 159, 166-171, 186-189, 224, 265-339, 345, 348-351, 354-357, 361, 363, 367, 371, 375, 379, 381, 383, 385, 388, 391, 394, 399, 427-445, 456, 460-461, 464, 467-468, 471-476, 484-589, 604-623, 626-629, 632-671, 674-687, 690-694, 697-701, 717-746, 752, 754, 772-774, 777-782, 793, 800-804, 807-808, 811-812, 815-819, 822-826, 829-833, 846-847, 850-852, 857-858, 861-863, 866-873, 876-882, 886, 889-894, 897-901, 904-908, 912-916, 919-923, 926-931, 935-937, 940-952, 955-973, 977, 980, 983, 986-988, 1006-1018, 1022, 1036, 1050, 1053, 1060, 1068, 1071-1074, 1077-1078, 1088, 1099-1104, 1107-1113, 1116-1153, 1189, 1195, 1201-1202, 1207, 1215-1232, 1243-1253, 1261-1272, 1280, 1288, 1294, 1302-1307, 1315-1324, 1327-1338, 1343-1353, 1386, 1390-1395, 1412, 1418, 1424, 1430, 1435-1436, 1439-1440, 1443-1444, 1447-1450, 1454-1457, 1460-1467, 1470-1485, 1492, 1496, 1500, 1504-1506, 1518-1525, 1548-1551, 1565-1568, 1583, 1586-1588, 1592-1597, 1600-1632, 1639, 1644-1648, 1651-1655, 1659-1660, 1667-1668, 1675-1676, 1683-1684, 1693-1704, 1712-1713, 1727, 1741-1745, 1751, 1755-1768, 1771-1775, 1778-1786, 1789-1793, 1800, 1807, 1848-1850, 1860-1862, 1872-1880, 1896, 1927, 1948, 1971-2014, 2201-2205, 2219-2229, 2262, 2265, 2279-2325, 2338-2366, 2377-2401, 2430, 2465-2508, 2520-2527, 2539-2573, 2589, 2593-2595, 2617, 2640-2644
sparkless/backend/polars/materializer.py                     302    134    56%   50-56, 59, 68-81, 85, 103, 106, 124-129, 190-209, 223-224, 239-240, 259-260, 287-298, 319, 327, 338, 347, 358-369, 393, 398-400, 414, 450-453, 474-475, 478-483, 486, 506-646, 651, 656, 663-667
sparkless/backend/polars/operation_executor.py               537    326    39%   52-53, 86-89, 96-99, 103-264, 269, 273, 280-304, 316-322, 339, 347-348, 354, 369-370, 382-387, 397, 411-412, 430-454, 470, 484, 486, 488, 494-509, 514-535, 540-544, 549-557, 560-566, 569-584, 587-590, 595-607, 610-625, 661-662, 669-676, 681-688, 697-708, 733-745, 780, 795-808, 814-817, 819, 823, 856, 861-862, 867, 872-893, 897, 900, 904, 926-927, 931-932, 953-973, 985, 997, 1014-1037, 1048, 1060, 1075
sparkless/backend/polars/parquet_storage.py                   41     41     0%   8-119
sparkless/backend/polars/schema_registry.py                   73     55    25%   42-43, 59-94, 110-190, 203-207, 220-222
sparkless/backend/polars/schema_utils.py                      31      6    81%   18-20, 35, 53, 65
sparkless/backend/polars/storage.py                          309    120    61%   61, 68-69, 82-83, 87-94, 98-103, 108, 149-152, 170-171, 183-185, 189-196, 206, 225-226, 269, 284-285, 297, 301-302, 306-310, 320-344, 371, 384-395, 415, 436, 448-452, 472-476, 492-502, 507-513, 517-533, 548, 569, 573, 592, 596, 612, 616, 654, 667, 671
sparkless/backend/polars/type_mapper.py                       83     48    42%   52, 59-92, 110, 116, 120, 122-124, 126, 130-146
sparkless/backend/polars/window_handler.py                   195    116    41%   37-38, 46-83, 88, 107-115, 126-128, 131-140, 152-158, 161-172, 184-190, 192-227, 229-255, 257-267, 269-275, 277-283, 298-302, 318-322, 329-333, 349-357, 372, 377
sparkless/backend/protocols.py                                12      0   100%
sparkless/compat/__init__.py                                   2      0   100%
sparkless/compat/datetime.py                                  73     51    30%   31, 43-45, 49-55, 61-69, 84-90, 102-108, 114-119, 127-132, 148-168
sparkless/config.py                                           55     17    69%   45-57, 63-64, 68, 76-80, 89-90, 105
sparkless/core/__init__.py                                     9      0   100%
sparkless/core/condition_evaluator.py                        727    683     6%   26-33, 47, 53, 68-242, 257-536, 553-573, 588-601, 621, 623, 632-776, 790-1198, 1213-1222, 1241-1254, 1267-1274, 1287, 1300-1304, 1318-1337
sparkless/core/data_validation.py                             80     39    51%   56-85, 91-113, 129, 136-137, 177-181, 205-206, 220-221
sparkless/core/ddl_adapter.py                                 31     12    61%   93-106
sparkless/core/exceptions/__init__.py                          6      0   100%
sparkless/core/exceptions/analysis.py                        100     68    32%   51, 57, 63, 72, 91, 109, 137-162, 170-202, 230-245, 269-272, 302-323
sparkless/core/exceptions/base.py                             22      4    82%   31, 61, 76, 91
sparkless/core/exceptions/execution.py                        29     12    59%   45, 63, 87-90, 114-117, 135, 153
sparkless/core/exceptions/operation.py                        87     64    26%   24-34, 49-58, 72-82, 96-106, 120-129, 152, 172-182, 196-205
sparkless/core/exceptions/py4j_compat.py                      10     10     0%   8-41
sparkless/core/exceptions/runtime.py                          41     25    39%   27, 53-57, 75, 101-107, 131-134, 158-161, 187-193
sparkless/core/exceptions/validation.py                       44     26    41%   27, 45, 63, 81, 107-111, 141-147, 171-174, 202-207
sparkless/core/interfaces/__init__.py                          5      0   100%
sparkless/core/interfaces/dataframe.py                       180     56    69%   20, 26, 31, 36, 41, 46, 51, 56, 61, 66, 71, 76, 81, 86, 91, 98, 103, 110, 115, 120, 125, 130, 136, 142, 151, 156, 161, 166, 171, 176, 181, 190, 195, 200, 205, 212, 217, 222, 227, 232, 241, 246, 251, 256, 261, 266, 275, 280, 285, 290, 295, 300, 305, 310, 315, 320
sparkless/core/interfaces/functions.py                       186     56    70%   23, 28, 33, 42, 47, 56, 61, 70, 75, 84, 89, 94, 99, 108, 113, 118, 123, 130, 135, 144, 149, 154, 159, 164, 173, 178, 185, 192, 197, 202, 207, 212, 221, 226, 231, 236, 241, 250, 255, 263, 273, 278, 283, 288, 293, 298, 303, 308, 313, 318, 323, 328, 333, 338, 343, 348
sparkless/core/interfaces/session.py                         111     32    71%   20, 26, 32, 38, 44, 50, 59, 64, 69, 76, 81, 86, 96, 101, 106, 115, 120, 125, 136, 141, 146, 151, 156, 161, 166, 175, 180, 185, 190, 199, 204, 209
sparkless/core/interfaces/storage.py                         126     38    70%   29, 34, 39, 44, 54, 59, 64, 69, 76, 83, 90, 97, 102, 106, 110, 114, 120, 126, 136, 142, 148, 153, 158, 163, 168, 173, 186, 192, 198, 204, 210, 215, 220, 229, 234, 239, 248, 253
sparkless/core/protocols.py                                   42      0   100%
sparkless/core/safe_evaluator.py                             125     83    34%   45-50, 66-67, 86, 88, 90, 95, 97-103, 105-134, 145-147, 150-152, 157-164, 169, 171, 173, 176-179, 184-212
sparkless/core/schema_inference.py                            89     21    76%   67, 89, 99, 118, 153, 165, 175-177, 219-220, 236-249
sparkless/core/type_utils.py                                  57     35    39%   20-21, 91-93, 112-121, 140-144, 164-168, 187-199
sparkless/core/types/__init__.py                               4      0   100%
sparkless/core/types/data_types.py                           139     38    73%   22, 27, 32, 37, 42, 47, 52, 57, 66, 76, 81, 91, 97, 102, 111, 121, 127, 132, 141, 146, 155, 160, 170, 175, 180, 190, 196, 201, 206, 211, 221, 226, 231, 240, 249, 254, 259, 264
sparkless/core/types/metadata.py                             166     47    72%   18, 23, 28, 33, 38, 43, 48, 53, 58, 63, 73, 79, 85, 91, 97, 103, 108, 113, 118, 128, 134, 140, 145, 150, 160, 166, 172, 177, 182, 187, 197, 203, 209, 215, 220, 225, 230, 239, 244, 249, 254, 259, 268, 273, 278, 283, 288
sparkless/core/types/schema.py                               121     36    70%   22, 28, 34, 40, 45, 50, 55, 60, 70, 75, 80, 85, 90, 95, 100, 105, 110, 115, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 185, 190, 195, 200, 209, 214, 221, 226
sparkless/data_generation/__init__.py                          4      4     0%   8-12
sparkless/data_generation/builder.py                          28     28     0%   8-85
sparkless/data_generation/convenience.py                       9      9     0%   8-64
sparkless/data_generation/generator.py                       174    174     0%   8-337
sparkless/dataframe/__init__.py                                6      0   100%
sparkless/dataframe/aggregations/__init__.py                   2      2     0%   8-10
sparkless/dataframe/aggregations/operations.py                69     69     0%   8-183
sparkless/dataframe/assertions/__init__.py                     3      3     0%   7-10
sparkless/dataframe/assertions/assertions.py                  26     26     0%   8-88
sparkless/dataframe/assertions/operations.py                  16     16     0%   8-45
sparkless/dataframe/attribute_handler.py                      23      4    83%   65-66, 72-73
sparkless/dataframe/casting/__init__.py                        2      2     0%   3-5
sparkless/dataframe/casting/type_converter.py                 95     95     0%   3-180
sparkless/dataframe/collection_handler.py                     23      9    61%   28-30, 37, 48-54, 63
sparkless/dataframe/condition_handler.py                      51     34    33%   56-62, 78, 107-120, 134-178
sparkless/dataframe/dataframe.py                             490    189    61%   187-191, 219-224, 243, 258, 270, 282, 286, 290, 304, 310, 320, 328, 332, 336, 345, 349, 375, 387, 395, 404, 408, 412, 441, 445, 462-463, 475-480, 486, 492, 496-502, 506, 510, 537-550, 562, 566, 571, 575, 579, 583, 593, 597, 606, 615, 621, 625, 629, 633, 639, 648, 652, 656, 662, 666, 676, 686, 697, 701, 705, 709, 715, 719, 723, 727, 735, 741, 745, 749, 753, 758, 762, 766, 770, 781, 800, 805, 836, 864-873, 901, 906, 925-933, 963-982, 988, 1059, 1065-1070, 1074, 1080, 1089, 1113, 1121, 1132, 1147, 1155, 1168, 1176, 1188, 1194, 1200, 1212-1218, 1233-1244, 1248, 1268-1276, 1285-1326
sparkless/dataframe/display/__init__.py                        3      3     0%   3-6
sparkless/dataframe/display/formatter.py                      37     37     0%   3-57
sparkless/dataframe/display/operations.py                    118    118     0%   8-274
sparkless/dataframe/evaluation/__init__.py                     2      0   100%
sparkless/dataframe/evaluation/expression_evaluator.py      2410   2120    12%   71, 76-83, 89-91, 96-110, 121-122, 126, 138, 142, 147-149, 157, 163-165, 171-213, 219-245, 251, 258, 262, 277-286, 294-418, 424-455, 459-492, 496-560, 567-590, 594, 598, 604, 610-662, 666, 670, 681, 687-691, 698, 703, 707, 711, 713, 716, 720-724, 732-771, 777-962, 968-1045, 1051-1084, 1090-1141, 1147-1233, 1238-1254, 1261-1273, 1277-1292, 1296-1311, 1315-1330, 1334-1349, 1360-1365, 1369-1380, 1384, 1627, 1631, 1635-1639, 1643-1647, 1651-1655, 1659-1672, 1676-1683, 1687-1697, 1701-1711, 1715-1717, 1723-1726, 1730-1733, 1737-1744, 1748-1753, 1757-1762, 1766-1782, 1786-1797, 1801-1809, 1815-1817, 1821-1826, 1830-1832, 1836-1838, 1844, 1848-1854, 1858, 1862-1867, 1871-1873, 1877-1879, 1883, 1887, 1891, 1899, 1903, 1907-1910, 1914-1916, 1920-1925, 1929-1932, 1936-1948, 1955, 1959-1991, 1995-2000, 2004-2026, 2030-2052, 2058-2074, 2078-2109, 2115-2150, 2156-2163, 2167-2187, 2191-2234, 2238-2255, 2259-2272, 2277, 2281-2282, 2286, 2290, 2294, 2300-2309, 2313-2322, 2326-2333, 2339, 2343-2357, 2361-2368, 2372-2386, 2390-2397, 2401-2408, 2412-2419, 2423-2432, 2436-2445, 2449-2458, 2462-2469, 2473-2480, 2484-2491, 2495-2502, 2506-2513, 2519, 2523-2532, 2537, 2542, 2547-2579, 2583-2592, 2598, 2604, 2608-2619, 2625, 2632, 2637, 2643, 2648-2672, 2677, 2682, 2687, 2696-2728, 2732-2776, 2780-2824, 2828-2855, 2860-2881, 2889-2951, 2955-2962, 2966-2986, 2992, 2998, 3002-3117, 3122-3133, 3137-3146, 3150, 3154, 3158, 3162, 3166, 3170, 3174, 3178-3183, 3187-3193, 3197-3202, 3206-3211, 3220, 3234-3268, 3274, 3278-3285, 3289-3300, 3305-3314, 3320-3329, 3335-3340, 3346-3351, 3357-3365, 3371-3379, 3383, 3387-3393, 3397-3408, 3412-3415, 3419-3425, 3429-3431, 3436, 3441-3453, 3457, 3461-3467, 3471-3477, 3483-3493, 3497-3504, 3509, 3513-3515, 3519-3542, 3546-3569, 3574, 3579, 3584, 3589, 3594, 3599, 3603-3615, 3621-3628, 3634-3641, 3645-3654, 3660-3667, 3673-3680, 3686-3693, 3701-3715, 3719-3726, 3730-3737, 3742-3757, 3762, 3767, 3773-3784, 3791-3794, 3800-3803, 3809-3814, 3819-3823, 3827-3844, 3850-3865, 3871-3886, 3892-3895, 3899-3901, 3906-3914, 3920-3947, 3952-3961, 3965-3967, 3971-3973, 3978-3997, 4001-4018, 4022-4039, 4043-4060, 4064-4069, 4075-4086, 4090-4101, 4105-4110
sparkless/dataframe/export.py                                 15     15     0%   8-46
sparkless/dataframe/grouped/__init__.py                        5      0   100%
sparkless/dataframe/grouped/base.py                          903    700    22%   78, 85, 91-135, 166-175, 178, 182-186, 203, 213-239, 256-272, 289-292, 315-316, 361-362, 364-365, 397-443, 452-467, 492-532, 553-604, 641, 644-651, 653-654, 676-679, 685, 687-690, 707, 709-716, 718-719, 741-744, 750, 752-755, 783-784, 789-795, 810-811, 816-1419, 1436-1535, 1546-1553, 1564-1571, 1582-1593, 1604-1611, 1622-1629, 1640-1649, 1660-1669, 1680-1689, 1700-1709, 1720-1729, 1740-1749, 1760-1774, 1785-1799, 1813-1830, 1852-1919, 1941-1996
sparkless/dataframe/grouped/cube.py                           85     77     9%   29-30, 46-212
sparkless/dataframe/grouped/pivot.py                         121    112     7%   35-38, 54-123, 129-160, 166-212, 220-252
sparkless/dataframe/grouped/rollup.py                         86     79     8%   28-29, 47-215
sparkless/dataframe/joins/__init__.py                          2      2     0%   8-10
sparkless/dataframe/joins/operations.py                      140    140     0%   8-350
sparkless/dataframe/lazy.py                                  859    610    29%   45-47, 68, 76, 89, 140-142, 149-150, 159-171, 178-188, 202-232, 317, 333-346, 364-378, 384-420, 426-435, 448-450, 454, 484, 517, 540-582, 602, 611, 620, 627, 656, 682, 697, 702, 705, 710, 714, 717, 761-764, 774, 784-788, 794, 801-814, 819-820, 825-826, 864, 872-1236, 1238-1242, 1244-1335, 1337-1348, 1357, 1361, 1379-1444, 1458-1719, 1732-1754, 1769-1926, 1942-1954
sparkless/dataframe/operations/__init__.py                     2      0   100%
sparkless/dataframe/operations/aggregation_operations.py     128    128     0%   3-313
sparkless/dataframe/operations/join_operations.py            157    157     0%   3-329
sparkless/dataframe/operations/misc.py                       502    458     9%   54-75, 84-99, 121-169, 190-204, 221-262, 277-361, 375-455, 472-503, 520-543, 565-580, 593-608, 627-634, 659-691, 719-780, 812-871, 898-935, 972-1023, 1031-1062, 1066-1084, 1098-1125, 1140-1145, 1165, 1181-1183, 1197-1204, 1215-1216, 1225, 1243-1251, 1266-1269, 1282-1287, 1295, 1308-1311, 1319, 1324, 1333-1334, 1343, 1357-1369
sparkless/dataframe/operations/set_operations.py             127    108    15%   27-93, 98, 120-134, 149-205, 211-231, 237-254, 259-261
sparkless/dataframe/protocols.py                              49      0   100%
sparkless/dataframe/rdd.py                                    78     52    33%   25, 33, 41, 52, 60, 68-69, 80, 91, 102-110, 121-128, 140-151, 159, 170, 178, 186, 194, 202, 214, 225-228, 239-246, 254, 262
sparkless/dataframe/reader.py                                187    155    17%   66-69, 83-84, 99-100, 114-115, 129-138, 157-190, 206-259, 266-277, 281-288, 294-310, 316-351, 355-359, 363-366, 370-388, 392-396, 402-411, 415, 419, 423, 438, 453, 470-472
sparkless/dataframe/schema/__init__.py                         3      0   100%
sparkless/dataframe/schema/operations.py                      22      9    59%   23-31, 39-41, 46, 51
sparkless/dataframe/schema/schema_manager.py                 304    179    41%   52, 96, 103, 108, 132, 154-166, 170-175, 182-220, 235-236, 264-266, 283-299, 304-319, 329, 331, 347-348, 352-355, 366-376, 381-417, 421-424, 428-431, 435-453, 457-463, 477-478, 492, 502-517, 525-528, 535-569
sparkless/dataframe/services/__init__.py                       8      0   100%
sparkless/dataframe/services/aggregation_service.py           69     45    35%   41, 66, 80-96, 110-126, 146-172
sparkless/dataframe/services/assertion_service.py             17      8    53%   25-27, 33-35, 41-43, 49-51
sparkless/dataframe/services/display_service.py              121     66    45%   40-50, 56-57, 78, 94, 101, 120-167, 171-174, 182-186, 195-204, 214, 220, 223, 227-232, 238-240, 244-250, 263-265, 277
sparkless/dataframe/services/join_service.py                 165     80    52%   104, 115, 124, 149-250, 322-344, 416-436
sparkless/dataframe/services/misc_service.py                 498    453     9%   43-64, 71-86, 108-156, 177-191, 208-249, 267-351, 365-445, 460-491, 508-531, 553-568, 581-596, 615-622, 647-679, 705-766, 798-857, 884-921, 958-1008, 1016-1049, 1053-1071, 1085-1112, 1127-1132, 1150, 1166-1168, 1182-1189, 1200-1203, 1212, 1230-1234, 1249, 1260-1265, 1271, 1282-1285, 1293, 1298, 1307-1308, 1317, 1331-1343
sparkless/dataframe/services/schema_service.py                 4      0   100%
sparkless/dataframe/services/transformation_service.py       216    151    30%   63, 74-78, 85-90, 103, 113-225, 249, 260, 283-293, 297-317, 331-352, 390-403, 419, 437, 455-459, 463, 467, 495-538, 558-578
sparkless/dataframe/sqlalchemy_query_builder.py              159    159     0%   8-303
sparkless/dataframe/transformations/__init__.py                2      2     0%   8-10
sparkless/dataframe/transformations/operations.py            211    211     0%   8-555
sparkless/dataframe/types.py                                   8      8     0%   8-25
sparkless/dataframe/validation/__init__.py                     2      0   100%
sparkless/dataframe/validation/column_validator.py           101     31    69%   68, 72, 88-91, 110, 133-173, 199, 205, 210, 213, 224, 233, 250, 252, 258, 263, 284, 307, 317-318, 328-330
sparkless/dataframe/validation_handler.py                     11      2    82%   39, 54
sparkless/dataframe/window_handler.py                        266    266     0%   8-598
sparkless/dataframe/writer.py                                359    200    44%   111-113, 127, 157-158, 172-173, 190-192, 203-208, 226-230, 233-236, 246-248, 256, 286, 292-294, 356-358, 405, 407, 458-482, 496, 508, 524, 536, 548, 560, 567-573, 577-593, 597-600, 606-615, 619-624, 627-634, 637-640, 643-659, 664-679, 683-688, 709-741, 780-783, 790-842, 872-939
sparkless/delta.py                                           299    249    17%   38-43, 53-66, 79-80, 92-108, 113-114, 119, 123-124, 129-144, 148-177, 181, 190, 202, 213-260, 274-315, 319, 322-326, 329-331, 334-342, 347-351, 356-375, 388-397, 401, 405, 408-413, 416-417, 420-421, 424-426, 429-431, 435-479, 482-488, 491-505, 512-516, 528-541, 546-549, 554-558, 566-594, 602-622
sparkless/error_simulation.py                                 89     89     0%   29-336
sparkless/errors.py                                           28     10    64%   57, 62, 67, 72, 79, 86, 91, 96, 101, 106
sparkless/functions/__init__.py                               29      4    86%   562-566
sparkless/functions/aggregate.py                             306    163    47%   64-69, 238-239, 254-255, 270-271, 286-287, 302-303, 318-319, 334-335, 350-351, 366-367, 382-383, 398-400, 419-423, 441-450, 468-477, 492-493, 510-511, 528-529, 546-547, 567-573, 593-599, 616-617, 634-635, 652-653, 670-673, 690-691, 708-709, 726-727, 744-745, 760-764, 782-783, 800-801, 814-816, 831-838, 852-860, 878-888, 906-915, 933-942, 962-974, 992-1001, 1019-1028, 1046-1055, 1073-1082, 1100-1109, 1130-1170
sparkless/functions/array.py                                 261    160    39%   56, 78-83, 106-111, 134-139, 161, 185, 213-219, 245-251, 277-283, 309-315, 346-356, 385-396, 418-421, 440-443, 466, 486-490, 511-514, 538-541, 561-564, 579-582, 599, 621-624, 639-642, 658, 676, 693-696, 711-714, 732-737, 757-760, 774-777, 789-792, 806-825, 848-878, 895-898, 913-931, 952-955, 973-977, 995-998, 1013-1014, 1029-1041, 1053-1055, 1067-1071
sparkless/functions/base.py                                  106     58    45%   65, 88, 100, 102, 104, 110-113, 120, 126, 139-150, 154-160, 164-173, 177-188, 192-202, 206-216, 233-234
sparkless/functions/bitwise.py                               108     67    38%   31-34, 50-53, 71, 86-89, 107-110, 125-128, 143-146, 161-168, 183-198, 213-228, 243-258, 276-283, 300-307, 324-331, 347-350, 367-370, 387-390, 405-408, 425-428
sparkless/functions/conditional.py                           366    287    22%   32-114, 146, 151, 211-216, 220-283, 297-299, 311-327, 341-370, 387-401, 413-417, 429-436, 448-453, 468, 485-517, 536, 551-562, 575-596, 621-636, 651-666, 681-696, 711-726, 741-756, 768-775, 787-794, 809-822, 837-853, 868-884, 899-915
sparkless/functions/core/__init__.py                           6      0   100%
sparkless/functions/core/column.py                           286    103    64%   40, 44, 48, 52, 60, 68, 80, 84, 88, 92, 96, 104, 112, 116, 120, 137, 141, 145, 196, 202, 206, 221-223, 227-229, 233-235, 243, 251-254, 262-265, 273-276, 284-287, 295-298, 306-309, 318, 390, 402, 404-405, 407-421, 423-427, 439, 456, 462, 466, 470, 474, 478, 482, 488, 490, 492, 494, 498, 500, 502-504, 530, 537-540, 543-547, 549, 551, 553, 555, 558-587
sparkless/functions/core/expressions.py                      109     74    32%   28-32, 55, 73, 91-94, 108-115, 127-129, 141-143, 155-157, 169-171, 188-228, 240-247, 259-266, 278-285, 297-304, 320-323
sparkless/functions/core/lambda_parser.py                    146    126    14%   58-134, 142-148, 167-175, 189-247, 260-274, 285-298, 309-314, 327-332, 359-361, 369, 377, 381-385
sparkless/functions/core/literals.py                         123     65    47%   49, 52, 65-76, 86, 108-110, 117-119, 123-125, 129-131, 135-137, 141-143, 147-149, 153-155, 159-161, 165-167, 171-173, 177-179, 183-185, 189-191, 195-197, 201-203, 207-209, 213, 217, 221-223, 227-229, 233-235, 239-241, 255-257, 261-263, 273-275, 279-281, 285-287
sparkless/functions/core/operations.py                       101     63    38%   27-29, 33-35, 39-41, 45-47, 51-53, 57-59, 63-65, 69, 73, 77-79, 83-85, 89-91, 95-97, 101-103, 107-109, 122, 126, 130, 134, 138, 142, 146, 160-173, 183, 187, 195, 203-205, 209-211, 219-221
sparkless/functions/core/sql_expr_parser.py                  241    121    50%   64-74, 86-97, 145, 147-153, 158-174, 179-196, 203-211, 216-224, 249-277, 295, 297, 301, 306, 315, 324, 371-372, 374-375, 385-392, 405-436
sparkless/functions/crypto.py                                 48     39    19%   49-71, 91-113, 133-155
sparkless/functions/datetime.py                              476    295    38%   52, 98, 107, 119-125, 137-143, 155-161, 173-179, 188-189, 205-218, 231-237, 262-301, 327-366, 390-429, 455-500, 520-549, 564-580, 595-601, 616-622, 637-646, 658-664, 676-682, 694-700, 712-718, 730-736, 748-754, 775, 781, 813, 819, 839-843, 855-859, 871-875, 888, 904, 920, 937-943, 955-961, 973-977, 989-993, 1005-1009, 1022-1031, 1046-1057, 1071, 1090, 1109, 1132-1142, 1162-1174, 1194-1205, 1214-1217, 1231-1236, 1245-1256, 1266-1277, 1300-1303, 1323-1326, 1351-1355, 1376-1379, 1405-1457, 1481-1486, 1507-1527, 1547-1550, 1566-1569, 1590-1593, 1612-1617, 1636-1637, 1654-1655, 1675-1683, 1701-1717, 1735-1751
sparkless/functions/functions.py                            1531    541    65%   67-77, 133-136, 142-162, 168-187, 193-212, 218-238, 259, 264, 286, 308, 315, 332, 337, 342, 347, 352, 357, 362, 367, 372, 385-387, 392, 399, 406, 413, 418, 423, 428, 433, 438, 443, 448, 453, 458, 463, 474, 481, 488, 493, 498, 503, 514, 524, 534, 539, 546, 555, 579, 584, 589, 596, 613, 618, 628, 633, 638, 643, 648, 655, 665, 686, 713, 718, 723, 728, 742, 747, 752, 772, 777, 782, 787, 792, 797, 804, 809, 814, 819, 824, 829, 834, 839, 844, 849, 854, 859, 864, 869, 879, 889, 894, 899, 904, 909, 914, 919, 970, 975, 980, 985, 990, 995, 1000, 1005, 1010, 1015, 1020, 1027, 1034, 1041, 1046, 1051, 1056, 1061, 1066, 1071, 1078, 1083, 1088, 1093, 1102, 1107, 1112, 1117, 1122, 1129, 1136, 1141, 1146, 1176-1179, 1198, 1205, 1212, 1217, 1222, 1227, 1243, 1248, 1253, 1258, 1270, 1275, 1285, 1290, 1295, 1300, 1305, 1310, 1315, 1320, 1341-1394, 1399, 1404, 1409, 1416, 1440, 1445, 1450, 1457, 1465, 1470, 1475, 1480, 1485, 1490, 1495, 1507-1512, 1523, 1530, 1537, 1543-1545, 1553-1560, 1569-1571, 1680-1687, 1744-1751, 1760-1767, 1783, 1788, 1793, 1798, 1803, 1815, 1822, 1829, 1847, 1854, 1861, 1868, 1878, 1887, 1893, 1898, 1908, 1913, 1920, 1925, 1930, 1937, 1947, 1952, 1967, 1979, 1984, 1989, 1994, 2003, 2008, 2014, 2019, 2024, 2029, 2036, 2042, 2047, 2052, 2059, 2066, 2073, 2082, 2088-2112, 2126-2132, 2143, 2148, 2153, 2159, 2164, 2169, 2174, 2179, 2184, 2189, 2194, 2199, 2207, 2216-2217, 2222, 2227, 2233, 2238, 2243, 2253, 2259, 2264, 2271, 2276, 2281, 2290-2292, 2300-2302, 2310-2312, 2320-2322, 2327-2329, 2334-2336, 2343-2345, 2352-2354, 2361-2363, 2370-2372, 2378, 2383, 2388, 2393, 2398, 2403, 2408, 2413, 2418, 2423, 2428, 2438-2440, 2445-2447, 2452-2454, 2459-2461, 2466-2468, 2477-2479, 2484-2486, 2491-2493, 2499-2501, 2506-2508, 2513-2515, 2520-2522, 2527-2529, 2535-2537, 2542-2544, 2549-2551, 2556-2558, 2563-2565, 2570-2572, 2577-2579, 2602-2624, 2653-2678, 2702-2709, 2726-2728, 2734, 2741, 2746, 2751, 2758, 2765, 2770, 2779, 2784, 2791, 2798, 2803, 2808, 2816, 2821, 2828, 2835, 2842, 2850, 2857, 2864, 2870, 2875, 2882, 2887, 2899, 2912, 2926, 2941, 2953, 2960, 2967, 2974, 2981, 2986, 2991, 2996, 3001, 3006, 3011, 3017, 3022, 3027, 3034, 3039, 3044, 3049, 3054, 3059, 3067, 3072, 3077, 3086, 3092, 3097, 3102, 3107, 3112, 3133-3150
sparkless/functions/json_csv.py                               41     41     0%   8-161
sparkless/functions/map.py                                    93     64    31%   51-54, 69-72, 87-90, 107-115, 138-143, 165-195, 216-219, 239-242, 265-271, 297-303, 329-335, 364-373, 396-403
sparkless/functions/math.py                                  307    140    54%   50, 65-69, 81-85, 99, 117, 132, 145, 161, 177, 197, 219-222, 237-240, 257-260, 277-280, 296, 322, 335, 351, 367, 382-387, 400, 425, 449-450, 462-463, 478-479, 491-492, 504-505, 517-518, 540-547, 559-560, 572-573, 585-586, 598-599, 611-612, 624-625, 637-638, 650-652, 669-671, 688-689, 702-703, 718-721, 748-751, 782-783, 796-797, 809-810, 822-823, 832-835, 844-847, 859-860, 875-880, 894-899, 914-933, 945, 963-976, 999-1040
sparkless/functions/metadata.py                               33     33     0%   8-109
sparkless/functions/ordering.py                               28     28     0%   7-93
sparkless/functions/pandas_types.py                            6      0   100%
sparkless/functions/string.py                                541    306    43%   50, 66, 82, 97-103, 115-121, 134, 150, 166, 184-196, 209-218, 231-237, 250-256, 268-274, 287-296, 309-318, 331-337, 350-356, 370-379, 395, 411-420, 435-450, 462-468, 480-484, 496, 508, 521-534, 550-561, 575, 597, 619, 644-657, 673-682, 695, 711, 726-730, 749-758, 780-792, 808, 828, 849, 867-871, 889-892, 912-915, 930-933, 952, 985, 1011-1014, 1035-1038, 1056-1059, 1080-1083, 1106, 1128, 1150-1155, 1183-1204, 1216-1219, 1232, 1246-1249, 1261-1280, 1297-1304, 1322-1325, 1340-1343, 1361-1364, 1384-1387, 1402-1405, 1421-1427, 1444-1447, 1462-1465, 1478-1484, 1499-1510, 1523-1532, 1545-1554, 1571-1580, 1597-1606, 1619-1625, 1643-1654, 1668-1680, 1695-1701, 1716-1722, 1734-1738, 1751-1762, 1777, 1802-1824, 1842-1849, 1867-1872, 1888-1897, 1909-1910
sparkless/functions/udf.py                                    51     41    20%   41-46, 57-58, 70-90, 119-121, 133-155
sparkless/functions/window_execution.py                      474    308    35%   48-57, 90-91, 103, 105, 107, 109, 111, 113, 120-133, 137-176, 189-190, 192-193, 201, 222-272, 279, 283, 285, 294, 298-359, 363-407, 411-455, 459-510, 515, 520, 535, 552, 556, 586, 601, 618, 622, 638, 652-689, 694, 709, 726, 757, 762, 766-784, 788-814, 818-862, 866-910
sparkless/functions/xml.py                                    63     37    41%   25-28, 50-60, 80-83, 103-106, 127-130, 151-154, 175-178, 199-202, 223-226, 247-250, 271-274
sparkless/optimizer/__init__.py                                3      0   100%
sparkless/optimizer/optimization_rules.py                    172    142    17%   16-61, 65-66, 71, 83-110, 114-115, 119-142, 150-170, 174-175, 181-184, 192-224, 228, 233, 241-266, 270, 275-278, 286-322, 326, 331, 339-359, 363-364, 369-374
sparkless/optimizer/query_optimizer.py                       256    185    28%   47-58, 67, 72, 80-125, 129-130, 135, 147-174, 178-179, 183-206, 214-234, 238-239, 245-248, 256-288, 292, 297, 305-330, 334, 339-342, 379-392, 403-408, 413, 418-456, 459-472, 477-504, 508, 512, 518
sparkless/performance_simulation.py                           91     91     0%   29-329
sparkless/session/__init__.py                                  4      0   100%
sparkless/session/catalog.py                                 246    128    48%   43, 47, 65, 69, 111, 131-133, 142, 150, 170, 173, 178, 187-190, 212, 215, 225, 230-233, 251-253, 267, 272, 275, 278, 281, 296-299, 309-312, 315-318, 338, 341, 344, 349-352, 374, 386-414, 431, 434, 438-443, 463, 466, 470-475, 484, 499, 502, 506-511, 528, 537, 546, 566-575, 599, 602, 606-610, 617, 620, 632, 649-682
sparkless/session/config/__init__.py                           2      0   100%
sparkless/session/config/configuration.py                     49     22    55%   67, 76, 84-85, 93, 101, 109, 117-118, 129, 133, 137, 175, 186-187, 198-199, 211-212, 223-224, 232
sparkless/session/context.py                                  36     10    72%   47, 51, 55, 92, 101, 110, 119, 123, 127, 131
sparkless/session/core/__init__.py                             4      0   100%
sparkless/session/core/builder.py                             28     17    39%   33-34, 45, 59-63, 72-90
sparkless/session/core/session.py                            223     65    71%   112, 164-167, 172, 177, 187, 192, 227-229, 239-244, 248-250, 263, 267, 277, 283, 296-298, 340, 358, 370, 381, 404, 411-426, 434-436, 458, 470, 499-500, 534, 543-545, 568-570, 587, 594, 601, 611, 618, 623-633, 642, 651-652, 657
sparkless/session/performance_tracker.py                      39     19    51%   57, 87-109, 117
sparkless/session/services/__init__.py                         6      0   100%
sparkless/session/services/dataframe_factory.py              116     67    42%   48, 60, 71, 73, 78, 85, 96, 113, 118, 127-130, 149, 159, 165, 183-189, 207-223, 234-305
sparkless/session/services/lifecycle_manager.py               21     10    52%   32-34, 42-43, 54-58
sparkless/session/services/mocking_coordinator.py             32     21    34%   39-57, 69-72, 84-86, 102-104, 109
sparkless/session/services/protocols.py                       20      0   100%
sparkless/session/services/sql_parameter_binder.py            29     25    14%   28-51, 62-74
sparkless/session/session.py                                   0      0   100%
sparkless/session/sql/__init__.py                              5      0   100%
sparkless/session/sql/executor.py                            731    312    57%   90, 101-104, 129-141, 149-243, 257-272, 295-302, 336-339, 354-356, 368, 373-377, 379-383, 393, 404-407, 439-454, 458-465, 473-486, 494-520, 556, 614, 621, 631-637, 640-646, 654-656, 691, 697-704, 716-728, 763, 770-772, 807, 813, 818, 837, 854, 867, 884, 906, 916, 918, 926-931, 955, 964-966, 985-986, 1027, 1030, 1032, 1036, 1041-1054, 1064, 1078, 1096-1097, 1131, 1140, 1174-1175, 1191, 1226-1254, 1305-1360, 1379-1512
sparkless/session/sql/optimizer.py                            65     48    26%   41-43, 47, 51, 68, 85-100, 111-114, 127, 142, 155, 168, 181, 192-234, 247-260
sparkless/session/sql/parser.py                              350     92    74%   45, 49, 263, 271-272, 297, 303, 305, 310-315, 356, 358, 447-448, 510-513, 561-572, 641, 664, 677, 742, 768, 776, 795-796, 798-799, 843, 850, 870-890, 904-982, 1003-1004
sparkless/session/sql/validation.py                           85     72    15%   42, 105-126, 137-166, 177-188, 199-216, 227-235, 246-265, 276-279, 292, 306-311, 322-323
sparkless/spark_types.py                                     377    184    51%   46-58, 95, 99, 107, 111-135, 251-253, 257, 270, 278-280, 284, 296, 320, 332, 344, 351-352, 355, 362-363, 366, 378, 387-389, 392, 401-403, 406, 415-417, 420, 443, 451-456, 482-487, 497-502, 505, 514, 517-518, 559-561, 565, 569-570, 578, 590, 603, 609-618, 623-638, 643-644, 682-685, 697-707, 715, 718-739, 743-747, 753-757, 761-768, 772-779, 783, 787-812, 826-847, 852-853, 858, 864-866, 878-879, 885-886
sparkless/sql/__init__.py                                     10      0   100%
sparkless/sql/functions.py                                    26      9    65%   58-67, 77-85
sparkless/sql/types.py                                         2      0   100%
sparkless/sql/utils.py                                         7      0   100%
sparkless/storage/__init__.py                                 10      0   100%
sparkless/storage/backends/__init__.py                         0      0   100%
sparkless/storage/backends/file.py                           199    137    31%   26-34, 39, 44, 49, 53-56, 64-69, 77-78, 87-101, 112-119, 127, 135-138, 142, 146, 150, 154-155, 159-161, 174-177, 188-191, 202-203, 211-216, 224-232, 238, 242, 246, 250, 254, 258, 262-264, 268, 272, 276, 288-291, 299-300, 311, 320-327, 335, 347-349, 364-367, 376-377, 389-393, 408-413, 428-430, 442-448, 460, 470-481, 492-501, 505-509, 515-520, 527
sparkless/storage/backends/memory.py                         133     84    37%   22-25, 34, 39, 44, 53-61, 72-77, 85, 93, 97, 101, 105, 109-110, 114-115, 139-141, 152, 160-161, 169, 187-188, 199, 208-209, 217, 229-231, 246-249, 258-259, 271-275, 290-295, 310-312, 324-330, 342, 352-370, 381-390, 402-406, 418-423, 430
sparkless/storage/manager.py                                 135     86    36%   40-45, 58, 70, 82, 94-98, 108, 119, 128-130, 138, 142-149, 153-159, 171, 186, 195, 208, 223, 237, 249, 258, 269, 283, 295, 303, 312, 325, 336, 344-349, 353-358, 366-378, 382, 390-400, 411-432
sparkless/storage/models.py                                   79     10    87%   77, 120-133, 138-140, 149-153
sparkless/storage/serialization/__init__.py                    0      0   100%
sparkless/storage/serialization/csv.py                        46     32    30%   23-30, 42-47, 57-62, 76-92, 104-120
sparkless/storage/serialization/json.py                       39     25    36%   23-24, 36-41, 51-63, 75-90, 102-118
sparkless/storage/sqlalchemy_helpers.py                       86     86     0%   8-343
sparkless/utils/profiling.py                                  96     40    58%   47-48, 58, 61, 71-76, 85, 88-90, 94, 99, 102, 118-135, 161-172, 182, 188
sparkless/window.py                                           61     13    79%   75, 80, 100, 105, 126, 144-148, 164, 195, 200, 205
----------------------------------------------------------------------------------------
TOTAL                                                      25293  16207    36%
Coverage HTML written to dir htmlcov
Coverage XML written to file coverage.xml
=========================== short test summary info ============================
FAILED tests/documentation/test_examples.py::TestExampleScripts::test_example_outputs_captured - AssertionError: assert 'Mock Spark' in '\U0001f680 Sparkless - Basic Usage Example\n============================================================\n\n1\ufe0f\u20e3  Creating Sparkless Session...\n   \u2713 Session created: BasicExample\n\n2\ufe0f\u20e3  Creating DataFrame...\n   \u2713 Created DataFrame: 5 rows, 4 columns\n\n   Schema:\nMockDataFrame Schema:\n |-- dept: StringType (nullable)\n |-- id: LongType (nullable)\n |-- name: StringType (nullable)\n |-- salary: LongType (nullable)\n\n   Data:\nMockDataFrame[5 rows, 4 columns]\n\ndept        id name    salary\nEngineering   1    Alice     80000   \nSales         2    Bob       75000   \nEngineering   3    Charlie   90000   \nMarketing     4    Diana     70000   \nSales         5    Eve       85000   \n\n3\ufe0f\u20e3  Filtering...\n   \u2713 Employees earning > $75k: 3\nMockDataFrame[5 rows, 4 columns]\n\ndept        id name    salary\nEngineering   1    Alice     80000   \nSales         2    Bob       75000   \nEngineering   3    Charlie   90000   \nMarketing     4    Diana     70000   \nSales         5    Eve       85000   \n\n4\ufe0f\u20e3  Column Operations...\n   \u2713 Applied transformations:\nMockDataFrame[5 rows, 4 columns]\n\ndept        id name    salary\nEngineering   1    Alice     80000   \nSales         2    Bob       75000   \nEngineering   3    Charlie   90000   \nMarketing     4    Diana     70000   \nSales         5    Eve       85000   \n\n5\ufe0f\u20e3  Aggregations...\n   \u2713 Department statistics:\nMockDataFrame[3 rows, 4 columns]\n\ndept        count avg_salary max_salary\nEngineering   2       85000.0      90000       \nSales         2       80000.0      85000       \nMarketing     1       70000.0      70000       \n\n6\ufe0f\u20e3  Window Functions...\n   \u2713 Salary rankings by department:\nMockDataFrame[5 rows, 4 columns]\n\ndept        id name    salary\nEngineering   1    Alice     80000   \nSales         2    Bob       75000   \nEngineering   3    Charlie   90000   \nMarketing     4    Diana     70000   \nSales         5    Eve       85000   \n\n7\ufe0f\u20e3  Joins...\n   \u2713 Joined with department locations:\nMockDataFrame[5 rows, 4 columns]\n\ndept        id name    salary\nEngineering   1    Alice     80000   \nSales         2    Bob       75000   \nEngineering   3    Charlie   90000   \nMarketing     4    Diana     70000   \nSales         5    Eve       85000   \n\n8\ufe0f\u20e3  SQL Queries...\n   \u2713 SQL query result (salary > 80k):\nMockDataFrame[5 rows, 3 columns]\n\ndept        id name    salary\nEngineering   1    Alice     80000   \nSales         2    Bob       75000   \nEngineering   3    Charlie   90000   \nMarketing     4    Diana     70000   \nSales         5    Eve       85000   \n\n9\ufe0f\u20e3  Lazy Evaluation...\n   \u2713 Transformations queued (not executed yet)\n   \u2713 Action executed: 4 results\n     - Charlie: $90,000\n     - Eve: $85,000\n     - Alice: $80,000\n     - Bob: $75,000\n\n\U0001f51f Cleanup...\n   \u2713 Session stopped\n\n\u2728 Example completed successfully!\n\n\U0001f4a1 Key Takeaways:\n   \u2022 Sparkless provides drop-in PySpark replacement\n   \u2022 No JVM required - 10x faster tests\n   \u2022 Full API compatibility with lazy evaluation\n   \u2022 Perfect for unit testing and CI/CD\n'
FAILED tests/parity/dataframe/test_groupby.py::TestGroupByParity::test_group_by - AssertionError: DataFrames are not equivalent:
Schema field names mismatch: mock=['department', 'count(1)'], expected=['department', 'count']
FAILED tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_sum_over_window - AssertionError: DataFrames are not equivalent:
Row count mismatch: mock=0, expected=4
FAILED tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_lag - AssertionError: DataFrames are not equivalent:
Schema field names mismatch: mock=['dept', 'hire_date', 'id', 'name', 'salary', 'prev_salary'], expected=['dept', 'hire_date', 'id', 'name', 'salary', 'lag_salary']
FAILED tests/parity/dataframe/test_window.py::TestWindowOperationsParity::test_lead - AssertionError: DataFrames are not equivalent:
Schema field names mismatch: mock=['dept', 'hire_date', 'id', 'name', 'salary', 'next_salary'], expected=['dept', 'hire_date', 'id', 'name', 'salary', 'lead_salary']
FAILED tests/parity/functions/test_array.py::TestArrayFunctionsParity::test_array_join - sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'tags'. Available columns: arr1, arr2, arr3, id, value
FAILED tests/parity/functions/test_array.py::TestArrayFunctionsParity::test_array_union - sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'scores'. Available columns: arr1, arr2, arr3, id, value
FAILED tests/parity/functions/test_array.py::TestArrayFunctionsParity::test_array_sort - sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'scores'. Available columns: arr1, arr2, arr3, id, value
FAILED tests/parity/functions/test_datetime.py::TestDatetimeFunctionsParity::test_dayofmonth - sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'hire_date'. Available columns: date, id, timestamp
FAILED tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_coalesce - sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'col1'. Available columns: age, department, id, name, salary
FAILED tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_isnull - sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'value'. Available columns: age, department, id, name, salary
FAILED tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_isnotnull - sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'value'. Available columns: age, department, id, name, salary
FAILED tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_when_otherwise - AssertionError: DataFrames are not equivalent:
Schema field names mismatch: mock=['level'], expected=['CASE WHEN (salary IS NULL) THEN 0 ELSE salary END']
Null mismatch in column 'level' row 0: mock=Junior, expected=0.0
Null mismatch in column 'level' row 1: mock=Junior, expected=50000.0
Null mismatch in column 'level' row 2: mock=Junior, expected=70000.0
Null mismatch in column 'level' row 3: mock=Senior, expected=80000.0
FAILED tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_nvl - sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'value'. Available columns: age, department, id, name, salary
FAILED tests/parity/functions/test_null_handling.py::TestNullHandlingFunctionsParity::test_nullif - sparkless.core.exceptions.operation.SparkColumnNotFoundError: 'DataFrame' object has no attribute 'col1'. Available columns: age, department, id, name, salary
FAILED tests/parity/internal/test_catalog.py::TestCatalogParity::test_get_table_in_database - sparkless.core.exceptions.analysis.AnalysisException: Table 'get_table.get_db' does not exist
FAILED tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_inner_join - assert 3 == 2
 +  where 3 = len([Row(name=Alice, dept_name=Alice), Row(name=Bob, dept_name=Bob), Row(name=Charlie, dept_name=Charlie)])
FAILED tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_having - assert 0 == 1
 +  where 0 = len([])
FAILED tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_subquery - assert 3 == 1
 +  where 3 = len([Row(name=Alice, salary=50000), Row(name=Bob, salary=60000), Row(name=Charlie, salary=70000)])
FAILED tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_like - assert 4 == 1
 +  where 4 = len([Row(name=Alice), Row(name=Bob), Row(name=Charlie), Row(name=David)])
FAILED tests/parity/sql/test_advanced.py::TestSQLAdvancedParity::test_sql_with_in_clause - assert 3 == 2
 +  where 3 = len([Row(age=25, name=Alice), Row(age=30, name=Bob), Row(age=35, name=Charlie)])
FAILED tests/parity/sql/test_ddl.py::TestSQLDDLParity::test_create_table_with_select - sparkless.core.exceptions.execution.QueryExecutionException: CREATE TABLE requires column definitions
FAILED tests/parity/sql/test_dml.py::TestSQLDMLParity::test_insert_into_table - AssertionError: assert '30' == 'Alice'
  
  - Alice
  + 30
FAILED tests/parity/sql/test_dml.py::TestSQLDMLParity::test_update_table - assert 3 == 1
 +  where 3 = len([Row(age=26, name=Alice), Row(age=30, name=Bob), Row(age=35, name=Charlie)])
FAILED tests/parity/sql/test_dml.py::TestSQLDMLParity::test_insert_from_select - assert 3 == 2
 +  where 3 = len([Row(name=Alice, age=25), Row(name=Bob, age=30), Row(name=Charlie, age=35)])
FAILED tests/parity/sql/test_queries.py::TestSQLQueriesParity::test_basic_select - AssertionError: DataFrames are not equivalent:
Schema field count mismatch: mock=4, expected=3
FAILED tests/parity/sql/test_queries.py::TestSQLQueriesParity::test_filtered_select - AssertionError: DataFrames are not equivalent:
Row count mismatch: mock=2, expected=1
FAILED tests/parity/sql/test_queries.py::TestSQLQueriesParity::test_group_by - sparkless.core.exceptions.execution.QueryExecutionException: Failed to execute query: 'DataFrame' object has no attribute 'department'. Available columns: age, id, name, salary
FAILED tests/parity/sql/test_queries.py::TestSQLQueriesParity::test_aggregation - sparkless.core.exceptions.execution.QueryExecutionException: Failed to execute query: 'DataFrame' object has no attribute 'department'. Available columns: age, id, name, salary
FAILED tests/parity/sql/test_show_describe.py::TestSQLShowDescribeParity::test_show_databases - AssertionError: assert 'show_test_db' in ['default', 'test']
FAILED tests/parity/sql/test_show_describe.py::TestSQLShowDescribeParity::test_show_tables - AssertionError: assert 'show_test_table' in ['users', 'orders']
FAILED tests/parity/sql/test_show_describe.py::TestSQLShowDescribeParity::test_show_tables_in_database - AssertionError: assert 'show_table' in ['users', 'orders']
FAILED tests/parity/sql/test_show_describe.py::TestSQLShowDescribeParity::test_describe_table - assert 0 == 3
 +  where 0 = len([])
FAILED tests/parity/sql/test_show_describe.py::TestSQLShowDescribeParity::test_describe_extended - assert 0 > 2
 +  where 0 = len([])
FAILED tests/parity/sql/test_show_describe.py::TestSQLShowDescribeParity::test_describe_column - assert 0 >= 1
 +  where 0 = len([])
FAILED tests/test_sparkcontext_validation.py::TestSessionValidation::test_aggregate_functions_require_session - Failed: DID NOT RAISE <class 'RuntimeError'>
=========== 36 failed, 182 passed, 3 skipped, 223 warnings in 17.34s ===========
